import mm.xmltodict as xmltodict
import mm.util as util

def get_org_metadata(**kwargs):
    retXml = kwargs.get('retXml', True)
    if retXml:
        metadata_result = get_org_metadata_xml()
    else:
        metadata_result = xmltodict.parse(get_org_metadata_xml(),postprocessor=util.xmltodict_postprocessor)
        metadata_result = metadata_result["soapenv:Envelope"]["soapenv:Body"]['describeMetadataResponse']['result']
    return metadata_result

def get_org_metadata_list():
    return [{"directoryName": "classes", "inFolder": False, "metaFile": True, "suffix": "cls", "xmlName": "ApexClass", "text": "ApexClass", "title": "ApexClass", "key": "ApexClass", "folder": True, "checked": True, "select": True, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "ApexClass", "hasChildTypes": False}, {"directoryName": "components", "inFolder": False, "metaFile": True, "suffix": "component", "xmlName": "ApexComponent", "text": "ApexComponent", "title": "ApexComponent", "key": "ApexComponent", "folder": True, "checked": True, "select": True, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "ApexComponent", "hasChildTypes": False}, {"directoryName": "pages", "inFolder": False, "metaFile": True, "suffix": "page", "xmlName": "ApexPage", "text": "ApexPage", "title": "ApexPage", "key": "ApexPage", "folder": True, "checked": True, "select": True, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "ApexPage", "hasChildTypes": False}, {"directoryName": "triggers", "inFolder": False, "metaFile": True, "suffix": "trigger", "xmlName": "ApexTrigger", "text": "ApexTrigger", "title": "ApexTrigger", "key": "ApexTrigger", "folder": True, "checked": True, "select": True, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "ApexTrigger", "hasChildTypes": False}, {"childXmlNames": ["CustomField", "BusinessProcess", "CompactLayout", "RecordType", "WebLink", "ValidationRule", "SharingReason", "ListView", "FieldSet"], "directoryName": "objects", "inFolder": False, "metaFile": False, "suffix": "object", "xmlName": "CustomObject", "text": "CustomObject", "title": "CustomObject", "key": "CustomObject", "folder": True, "checked": False, "select": False, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "CustomObject", "hasChildTypes": True}, {"directoryName": "profiles", "inFolder": False, "metaFile": False, "suffix": "profile", "xmlName": "Profile", "text": "Profile", "title": "Profile", "key": "Profile", "folder": True, "checked": False, "select": False, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "Profile", "hasChildTypes": False}, {"directoryName": "staticresources", "inFolder": False, "metaFile": True, "suffix": "resource", "xmlName": "StaticResource", "text": "StaticResource", "title": "StaticResource", "key": "StaticResource", "folder": True, "checked": True, "select": True, "children": [], "cls": "folder", "isLazy": True, "isFolder": True, "level": 1, "id": "StaticResource", "hasChildTypes": False}]

def get_org_metadata_xml():
    return '<?xml version="1.0" encoding="UTF-8"?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns="http://soap.sforce.com/2006/04/metadata"><soapenv:Body><describeMetadataResponse><result><metadataObjects><directoryName>installedPackages</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>installedPackage</suffix><xmlName>InstalledPackage</xmlName></metadataObjects><metadataObjects><childXmlNames>CustomLabel</childXmlNames><directoryName>labels</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>labels</suffix><xmlName>CustomLabels</xmlName></metadataObjects><metadataObjects><directoryName>staticresources</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>resource</suffix><xmlName>StaticResource</xmlName></metadataObjects><metadataObjects><directoryName>scontrols</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>scf</suffix><xmlName>Scontrol</xmlName></metadataObjects><metadataObjects><directoryName>components</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>component</suffix><xmlName>ApexComponent</xmlName></metadataObjects><metadataObjects><directoryName>pages</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>page</suffix><xmlName>ApexPage</xmlName></metadataObjects><metadataObjects><directoryName>queues</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>queue</suffix><xmlName>Queue</xmlName></metadataObjects><metadataObjects><directoryName>roles</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>role</suffix><xmlName>Role</xmlName></metadataObjects><metadataObjects><directoryName>groups</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>group</suffix><xmlName>Group</xmlName></metadataObjects><metadataObjects><childXmlNames>CustomField</childXmlNames><childXmlNames>BusinessProcess</childXmlNames><childXmlNames>CompactLayout</childXmlNames><childXmlNames>RecordType</childXmlNames><childXmlNames>WebLink</childXmlNames><childXmlNames>ValidationRule</childXmlNames><childXmlNames>SharingReason</childXmlNames><childXmlNames>ListView</childXmlNames><childXmlNames>FieldSet</childXmlNames><directoryName>objects</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>object</suffix><xmlName>CustomObject</xmlName></metadataObjects><metadataObjects><directoryName>reportTypes</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>reportType</suffix><xmlName>ReportType</xmlName></metadataObjects><metadataObjects><directoryName>reports</directoryName><inFolder>true</inFolder><metaFile>false</metaFile><suffix>report</suffix><xmlName>Report</xmlName></metadataObjects><metadataObjects><directoryName>dashboards</directoryName><inFolder>true</inFolder><metaFile>false</metaFile><suffix>dashboard</suffix><xmlName>Dashboard</xmlName></metadataObjects><metadataObjects><directoryName>analyticSnapshots</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>snapshot</suffix><xmlName>AnalyticSnapshot</xmlName></metadataObjects><metadataObjects><directoryName>layouts</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>layout</suffix><xmlName>Layout</xmlName></metadataObjects><metadataObjects><directoryName>documents</directoryName><inFolder>true</inFolder><metaFile>true</metaFile><xmlName>Document</xmlName></metadataObjects><metadataObjects><directoryName>weblinks</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>weblink</suffix><xmlName>CustomPageWebLink</xmlName></metadataObjects><metadataObjects><directoryName>quickActions</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>quickAction</suffix><xmlName>QuickAction</xmlName></metadataObjects><metadataObjects><directoryName>flexipages</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>flexipage</suffix><xmlName>FlexiPage</xmlName></metadataObjects><metadataObjects><directoryName>tabs</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>tab</suffix><xmlName>CustomTab</xmlName></metadataObjects><metadataObjects><directoryName>customApplicationComponents</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>customApplicationComponent</suffix><xmlName>CustomApplicationComponent</xmlName></metadataObjects><metadataObjects><directoryName>applications</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>app</suffix><xmlName>CustomApplication</xmlName></metadataObjects><metadataObjects><directoryName>letterhead</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>letter</suffix><xmlName>Letterhead</xmlName></metadataObjects><metadataObjects><directoryName>email</directoryName><inFolder>true</inFolder><metaFile>true</metaFile><suffix>email</suffix><xmlName>EmailTemplate</xmlName></metadataObjects><metadataObjects><directoryName>flows</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>flow</suffix><xmlName>Flow</xmlName></metadataObjects><metadataObjects><childXmlNames>WorkflowFieldUpdate</childXmlNames><childXmlNames>WorkflowKnowledgePublish</childXmlNames><childXmlNames>WorkflowTask</childXmlNames><childXmlNames>WorkflowAlert</childXmlNames><childXmlNames>WorkflowSend</childXmlNames><childXmlNames>WorkflowOutboundMessage</childXmlNames><childXmlNames>WorkflowFlowAction</childXmlNames><childXmlNames>WorkflowRule</childXmlNames><directoryName>workflows</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>workflow</suffix><xmlName>Workflow</xmlName></metadataObjects><metadataObjects><childXmlNames>AssignmentRule</childXmlNames><directoryName>assignmentRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>assignmentRules</suffix><xmlName>AssignmentRules</xmlName></metadataObjects><metadataObjects><childXmlNames>AutoResponseRule</childXmlNames><directoryName>autoResponseRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>autoResponseRules</suffix><xmlName>AutoResponseRules</xmlName></metadataObjects><metadataObjects><childXmlNames>EscalationRule</childXmlNames><directoryName>escalationRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>escalationRules</suffix><xmlName>EscalationRules</xmlName></metadataObjects><metadataObjects><directoryName>postTemplates</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>postTemplate</suffix><xmlName>PostTemplate</xmlName></metadataObjects><metadataObjects><directoryName>approvalProcesses</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>approvalProcess</suffix><xmlName>ApprovalProcess</xmlName></metadataObjects><metadataObjects><directoryName>homePageComponents</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>homePageComponent</suffix><xmlName>HomePageComponent</xmlName></metadataObjects><metadataObjects><directoryName>homePageLayouts</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>homePageLayout</suffix><xmlName>HomePageLayout</xmlName></metadataObjects><metadataObjects><directoryName>objectTranslations</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>objectTranslation</suffix><xmlName>CustomObjectTranslation</xmlName></metadataObjects><metadataObjects><directoryName>classes</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>cls</suffix><xmlName>ApexClass</xmlName></metadataObjects><metadataObjects><directoryName>triggers</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>trigger</suffix><xmlName>ApexTrigger</xmlName></metadataObjects><metadataObjects><directoryName>profiles</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>profile</suffix><xmlName>Profile</xmlName></metadataObjects><metadataObjects><directoryName>permissionsets</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>permissionset</suffix><xmlName>PermissionSet</xmlName></metadataObjects><metadataObjects><directoryName>datacategorygroups</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>datacategorygroup</suffix><xmlName>DataCategoryGroup</xmlName></metadataObjects><metadataObjects><directoryName>remoteSiteSettings</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>remoteSite</suffix><xmlName>RemoteSiteSetting</xmlName></metadataObjects><metadataObjects><directoryName>authproviders</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>authprovider</suffix><xmlName>AuthProvider</xmlName></metadataObjects><metadataObjects><directoryName>sites</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>site</suffix><xmlName>CustomSite</xmlName></metadataObjects><metadataObjects><childXmlNames>LeadOwnerSharingRule</childXmlNames><childXmlNames>LeadCriteriaBasedSharingRule</childXmlNames><directoryName>leadSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>LeadSharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>CampaignOwnerSharingRule</childXmlNames><childXmlNames>CampaignCriteriaBasedSharingRule</childXmlNames><directoryName>campaignSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>CampaignSharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>CaseOwnerSharingRule</childXmlNames><childXmlNames>CaseCriteriaBasedSharingRule</childXmlNames><directoryName>caseSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>CaseSharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>ContactOwnerSharingRule</childXmlNames><childXmlNames>ContactCriteriaBasedSharingRule</childXmlNames><directoryName>contactSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>ContactSharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>OpportunityOwnerSharingRule</childXmlNames><childXmlNames>OpportunityCriteriaBasedSharingRule</childXmlNames><directoryName>opportunitySharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>OpportunitySharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>AccountOwnerSharingRule</childXmlNames><childXmlNames>AccountCriteriaBasedSharingRule</childXmlNames><directoryName>accountSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>AccountSharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>CustomObjectOwnerSharingRule</childXmlNames><childXmlNames>CustomObjectCriteriaBasedSharingRule</childXmlNames><directoryName>customObjectSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>CustomObjectSharingRules</xmlName></metadataObjects><metadataObjects><childXmlNames>UserMembershipSharingRule</childXmlNames><childXmlNames>UserCriteriaBasedSharingRule</childXmlNames><directoryName>userSharingRules</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingRules</suffix><xmlName>UserSharingRules</xmlName></metadataObjects><metadataObjects><directoryName>sharingSets</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>sharingSet</suffix><xmlName>SharingSet</xmlName></metadataObjects><metadataObjects><directoryName>communities</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>community</suffix><xmlName>Community</xmlName></metadataObjects><metadataObjects><directoryName>callCenters</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>callCenter</suffix><xmlName>CallCenter</xmlName></metadataObjects><metadataObjects><directoryName>connectedApps</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>connectedApp</suffix><xmlName>ConnectedApp</xmlName></metadataObjects><metadataObjects><directoryName>appMenus</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>appMenu</suffix><xmlName>AppMenu</xmlName></metadataObjects><metadataObjects><directoryName>siteDotComSites</directoryName><inFolder>false</inFolder><metaFile>true</metaFile><suffix>site</suffix><xmlName>SiteDotCom</xmlName></metadataObjects><metadataObjects><directoryName>samlssoconfigs</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>samlssoconfig</suffix><xmlName>SamlSsoConfig</xmlName></metadataObjects><metadataObjects><directoryName>synonymDictionaries</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>synonymDictionary</suffix><xmlName>SynonymDictionary</xmlName></metadataObjects><metadataObjects><directoryName>settings</directoryName><inFolder>false</inFolder><metaFile>false</metaFile><suffix>settings</suffix><xmlName>Settings</xmlName></metadataObjects><organizationNamespace></organizationNamespace><partialSaveAllowed>true</partialSaveAllowed><testRequired>false</testRequired></result></describeMetadataResponse></soapenv:Body></soapenv:Envelope>'